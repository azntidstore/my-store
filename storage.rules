rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Match any file in the bucket
    match /{allPaths=**} {
      // Allow read access to anyone (for displaying images on the site)
      allow read: if true;

      // Allow write (create, update, delete) only for authenticated users (admins)
      // and validate file type and size.
      allow write: if request.auth != null &&
                   // File size validation: less than 5MB
                   request.resource.size < 5 * 1024 * 1024 &&
                   // File type validation: must be an image (jpeg, png, or webp)
                   request.resource.contentType.matches('image/(jpeg|png|webp)');
    }
  }
}
